webpackJsonp([1],{cU7a:function(t,e){},fXj9:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=a("Xxa5"),o=a.n(r),n=a("exGp"),i=a.n(n),s=a("qVsQ"),c=(a("NYxO"),{name:"ConfirmDialog",props:{confirmedDialog:{type:[String,Boolean],default:""},idResult:{type:[String,Number],default:0},groupResult:{type:[String,Number],default:0},yodResult:{type:[String,Number],default:0},result:{type:[Object],default:function(){}}},data:function(){return{id:"",dialog:!1}},watch:{dialog:function(t){var e=this;t&&setTimeout(function(){return e.dialog=!1},3e3)}},methods:{closeDialog:function(){this.$emit("emitCloseDialog",!1)},confirmedSubmit:function(){var t=this;this.dialog=!0;var e={groupId:this.result.groupId,groupName:this.result.groupName,yodSamma:this.result.yodSamma,dateTransaction:this.result.dateTransaction};s.a.collection("yodTransactions").add(e).then(function(e){return t.$router.push("/form")}).catch(function(t){return console.log(err)})},knowIdUser:function(){var t=this;return i()(o.a.mark(function e(){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.a.collection("yodByUser").where("groupId","==",t.groupResult).get().then(function(e){e.forEach(function(e){t.id=e.id,t.groupId=e.data().groupId})});case 2:console.log(t.id);case 3:case"end":return e.stop()}},e,t)}))()},saveUserTransac:function(){var t=this;s.a.collection("yodByUser").doc(this.id).collection("transactions").add({groupId:this.groupId,groupName:this.groupName,yodSamma:this.yodSamma,date:this.date,merge:!0}).then(function(e){return t.$router.push("/group")}).catch(function(t){return console.log(err)})},savetwofunction:function(){var t=this;return i()(o.a.mark(function e(){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.knowIdUser(),e.next=3,t.confirmedSubmit();case 3:case"end":return e.stop()}},e,t)}))()},savetwocollection:function(){var t=this;return i()(o.a.mark(function e(){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.savetwofunction(),e.next=3,t.saveUserTransac();case 3:case"end":return e.stop()}},e,t)}))()}}}),l={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("v-dialog",{attrs:{persistent:"","max-width":"400"},model:{value:t.confirmedDialog,callback:function(e){t.confirmedDialog=e},expression:"confirmedDialog"}},[a("v-card",[a("v-card-text",[a("v-layout",{attrs:{column:"","justify-center":"","align-center":""}},[t.groupResult>0?a("v-flex",{staticClass:"grey--text",attrs:{xs12:""}},[a("p",{staticClass:"title font-weight-bold"},[t._v("G - ")]),t._v(" "),a("p",{staticClass:"display-4 font-weight-bold"},[t._v(t._s(t.groupResult))])]):t._e(),t._v(" "),a("v-flex",{attrs:{xs12:""}},[a("p",[t._v(" ")])]),t._v(" "),t.yodResult>0?a("v-flex",{staticClass:"blue--text",attrs:{xs12:""}},[a("p",{staticClass:"title font-weight-bold"},[t._v("ยอดคำภาวนา")]),t._v(" "),a("p",{staticClass:"display-4 font-weight-bold light-blue--text"},[t._v("\n              "+t._s(t.yodResult)+"\n            ")])]):t._e()],1)],1),t._v(" "),a("v-card-actions",{staticClass:"grey lighten-5 "},[a("v-spacer"),t._v(" "),a("v-btn",{attrs:{flat:"",color:"indigo"},on:{click:function(e){return t.closeDialog()}}},[t._v("กลับไปแก้ไข")]),t._v(" "),a("v-btn",{attrs:{disabled:t.dialog,loading:t.dialog,round:"",color:"green darken-2 white--text"},on:{"~click":function(e){return t.savetwocollection()}}},[t._v("ยืนยัน")])],1)],1)],1)],1)},staticRenderFns:[]},u=a("VU/8")(c,l,!1,null,null,null).exports,d=a("kxiW"),f={name:"register-group",components:{ConfirmDialog:u},data:function(){return{confirmedDialog:"",valid:!1,id:"",groupId:"",groupName:"",yodSamma:"",date:(new Date).toISOString().substr(0,10),menu:!1,modal:!1,menu2:!1,lastUpdated:"",bundleForm:{}}},methods:{clear:function(){this.$refs.uForm.reset(),this.bundleForm={}},confirmed:function(){this.$refs.uForm.validate(),this.bundleForm={groupId:this.groupId,groupName:this.groupName,yodSamma:this.yodSamma,dateTransaction:this.date},this.date&&(this.confirmedDialog=!this.confirmedDialog)},saveTransac:function(){var t=this;return i()(o.a.mark(function e(){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.$refs.uForm.validate(),e.next=3,s.a.collection("yodTransactions").add({groupId:"G"+t.groupId,groupName:t.groupName,yodSamma:t.yodSamma,lastUpdated:d.firestore.FieldValue.serverTimestamp(),date:t.date}).catch(function(t){return console.log(err)});case 3:case"end":return e.stop()}},e,t)}))()},knowIdUser:function(){var t=this;return i()(o.a.mark(function e(){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.a.collection("yodByUser").where("groupId","==",t.groupId).get().then(function(e){e.forEach(function(e){t.id=e.id,t.groupId=e.data().groupId})});case 2:console.log(t.id);case 3:case"end":return e.stop()}},e,t)}))()},saveUserTransac:function(){var t=this;return i()(o.a.mark(function e(){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.a.collection("yodByUser").doc("G"+t.groupId).collection("transactions").add({groupId:"G"+t.groupId,groupName:t.groupName,yodSamma:t.yodSamma,date:t.date,lastUpdated:d.firestore.FieldValue.serverTimestamp(),merge:!0}).catch(function(t){return console.log(err)});case 2:case"end":return e.stop()}},e,t)}))()},savetwocollection:function(){var t=this;return i()(o.a.mark(function e(){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.saveTransac(),e.next=3,t.saveUserTransac();case 3:case"end":return e.stop()}},e,t)}))()}}},v={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-container",[a("v-layout",{attrs:{column:"",wrap:"","align-center":"","justify-center":""}},[a("v-flex"),t._v(" "),a("v-flex",{attrs:{xs12:"",sm8:"",md4:""}},[a("v-card",{staticClass:"elevation-12"},[a("v-toolbar",{attrs:{dark:"",color:"teal darken-2"}},[a("v-toolbar-title",[t._v("ส่งยอดคำภาวนา")])],1),t._v(" "),a("v-card-text",[a("v-form",{ref:"uForm",attrs:{"lazy-validation":""},model:{value:t.valid,callback:function(e){t.valid=e},expression:"valid"}},[a("v-text-field",{attrs:{"prepend-icon":"G",rules:[function(t){return!!t||"กรุณากรอกรหัสทีมของท่าน"}]},model:{value:t.groupId,callback:function(e){t.groupId=e},expression:"groupId"}}),t._v(" "),a("v-text-field",{attrs:{"prepend-icon":"thumb_up_alt",label:"ยอดคำภาวนา",type:"number"},model:{value:t.yodSamma,callback:function(e){t.yodSamma=t._n(e)},expression:"yodSamma"}}),t._v(" "),a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{xs12:"",sm6:"",md4:""}},[a("v-dialog",{ref:"dialog",attrs:{"return-value":t.date,persistent:"",lazy:"","full-width":"",width:"290px"},on:{"update:returnValue":function(e){t.date=e},"update:return-value":function(e){t.date=e}},model:{value:t.modal,callback:function(e){t.modal=e},expression:"modal"}},[a("v-text-field",{attrs:{slot:"activator",label:"ยอดของวันที่","prepend-icon":"event",readonly:""},slot:"activator",model:{value:t.date,callback:function(e){t.date=e},expression:"date"}}),t._v(" "),a("v-date-picker",{attrs:{locale:"th","prev-icon":"keyboard_arrow_left","next-icon":"keyboard_arrow_right",next:"",scrollable:"",color:"teal darken-2"},model:{value:t.date,callback:function(e){t.date=e},expression:"date"}},[a("v-spacer"),t._v(" "),a("v-btn",{attrs:{flat:"",color:"teal darken-2"},on:{click:function(e){t.modal=!1}}},[t._v("Cancel")]),t._v(" "),a("v-btn",{attrs:{flat:"",color:"teal darken-2"},on:{click:function(e){return t.$refs.dialog.save(t.date)}}},[t._v("OK")])],1)],1)],1)],1)],1)],1),t._v(" "),a("v-card-actions",[a("v-btn",{attrs:{flat:"",color:"red lighten-1"},on:{click:function(e){return t.clear()}}},[t._v("ล้างฟอร์ม")]),t._v(" "),a("v-spacer"),t._v(" "),a("router-link",{attrs:{to:{name:"view-yod-group",params:{groupId:"G"+this.groupId}}}},[a("v-btn",{attrs:{disabled:!t.valid,color:"green darken-4",round:"",dark:"",large:""},on:{"~click":function(e){return t.savetwocollection()}}},[t._v("ส่งยอด\n            ")])],1)],1)],1)],1),t._v(" "),a("v-flex",{attrs:{xs12:"",sm8:"",md6:""}},[a("ConfirmDialog",{attrs:{"confirmed-dialog":t.confirmedDialog,result:t.bundleForm,"group-result":t.groupId,"yod-result":t.yodSamma},on:{emitCloseDialog:function(e){t.confirmedDialog=arguments[0]}}})],1)],1)],1)},staticRenderFns:[]};var m=a("VU/8")(f,v,!1,function(t){a("cU7a")},null,null);e.default=m.exports}});
//# sourceMappingURL=1.76fde3d553d70cabc96d.js.map